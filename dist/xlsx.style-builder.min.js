let XmlNode=function(){function a(b,c,d){return this instanceof a?(this.tagName=b,this._attributes=c||{},this._children=d||[],this._prefix="",this):new a(b,c,d)}a.prototype.createElement=function(){return new a(arguments)},a.prototype.children=function(){return this._children},a.prototype.append=function(a){return this._children.push(a),this},a.prototype.prefix=function(a){return 0===arguments.length?this._prefix:(this._prefix=a,this)},a.prototype.attr=function(a,b){if(void 0===b)return delete this._attributes[a],this;if(0===arguments.length)return this._attributes;if("string"==typeof a&&1===arguments.length)return this._attributes.attr[a];if("object"==typeof a&&1===arguments.length)for(let b in a)a.hasOwnProperty(b)&&(this._attributes[b]=a[b]);else 2===arguments.length&&"string"==typeof a&&(this._attributes[a]=b);return this};let b={};return b["\""]="&quot;",b["'"]="&apos;",a.prototype.escapeAttributeValue=function(a){return"\""+a.replace(/"/g,"&quot;")+"\""},a.prototype.toXml=function(a){a||(a=this);let b=a._prefix;b+="<"+a.tagName;let c=a._attributes;if(c)for(let a in c)c.hasOwnProperty(a)&&(b+=" "+a+"="+this.escapeAttributeValue(""+c[a])+"");if(a._children&&0<a._children.length){b+=">";for(let c=0;c<a._children.length;c++)b+=this.toXml(a._children[c]);b+="</"+a.tagName+">"}else b+="/>";return b},a}();var StyleBuilder=function(a){let b=164,c={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:"\"\u4E0A\u5348/\u4E0B\u5348 \"hh\"\u6642\"mm\"\u5206\"ss\"\u79D2 \""},d={};for(let b in c)d[c[b]]=b;let e={};return{initialize:function(a){this.$fonts=XmlNode("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=XmlNode("fills").attr("count",0),this.$borders=XmlNode("borders").attr("count",0),this.$numFmts=XmlNode("numFmts").attr("count",0),this.$cellStyleXfs=XmlNode("cellStyleXfs"),this.$xf=XmlNode("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=XmlNode("cellXfs").attr("count",0),this.$cellStyles=XmlNode("cellStyles").append(XmlNode("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=XmlNode("dxfs").attr("count","0"),this.$tableStyles=XmlNode("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=XmlNode("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>").append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);let b=a.defaultCellStyle||{};b.font||(b.font={name:"Calibri",sz:"12"}),b.font.name||(b.font.name="Calibri"),b.font.sz||(b.font.sz=11),b.fill||(b.fill={patternType:"none",fgColor:{}}),b.border||(b.border={}),b.numFmt||(b.numFmt=0),this.defaultStyle=b;let c=JSON.parse(JSON.stringify(b));return c.fill={patternType:"gray125",fgColor:{}},this.addStyles([b,c]),this},addStyle:function(a){let b=JSON.stringify(a),c=e[b];return void 0===c?(c=this._addXf(a),e[b]=c):c=e[b],c},addStyles:function(a){let b=this;return a.map(function(a){return b.addStyle(a)})},_duckTypeStyle:function(a){return"object"==typeof a&&(a.patternFill||a.fgColor)?{fill:a}:a.font||a.numFmt||a.border||a.fill?a:this._getStyleCSS(a)},_getStyleCSS:function(a){return a},_addXf:function(a){let b=this._addFont(a.font),c=this._addFill(a.fill),d=this._addBorder(a.border),e=this._addNumFmt(a.numFmt),f=XmlNode("xf").attr("numFmtId",e).attr("fontId",b).attr("fillId",c).attr("borderId",d).attr("xfId","0");if(0<b&&f.attr("applyFont","1"),0<c&&f.attr("applyFill","1"),0<d&&f.attr("applyBorder","1"),0<e&&f.attr("applyNumberFormat","1"),a.alignment){let b=XmlNode("alignment");a.alignment.horizontal&&b.attr("horizontal",a.alignment.horizontal),a.alignment.vertical&&b.attr("vertical",a.alignment.vertical),a.alignment.indent&&b.attr("indent",a.alignment.indent),a.alignment.readingOrder&&b.attr("readingOrder",a.alignment.readingOrder),a.alignment.wrapText&&b.attr("wrapText",a.alignment.wrapText),void 0!==a.alignment.textRotation&&b.attr("textRotation",a.alignment.textRotation),f.append(b).attr("applyAlignment",1)}this.$cellXfs.append(f);let g=+this.$cellXfs.children().length;return this.$cellXfs.attr("count",g),g-1},_addFont:function(a){if(!a)return 0;let b=XmlNode("font").append(XmlNode("sz").attr("val",a.sz||this.defaultStyle.font.sz)).append(XmlNode("name").attr("val",a.name||this.defaultStyle.font.name));a.bold&&b.append(XmlNode("b")),a.underline&&b.append(XmlNode("u")),a.italic&&b.append(XmlNode("i")),a.strike&&b.append(XmlNode("strike")),a.outline&&b.append(XmlNode("outline")),a.shadow&&b.append(XmlNode("shadow")),a.vertAlign&&b.append(XmlNode("vertAlign").attr("val",a.vertAlign)),a.color&&(a.color.theme?(b.append(XmlNode("color").attr("theme",a.color.theme)),a.color.tint&&b.append(XmlNode("tint").attr("theme",a.color.tint))):a.color.rgb&&b.append(XmlNode("color").attr("rgb",a.color.rgb))),this.$fonts.append(b);let c=this.$fonts.children().length;return this.$fonts.attr("count",c),c-1},_addNumFmt:function(a){if(!a)return 0;if("string"==typeof a){let b=d[a];if(0<=b)return b}if(/^[0-9]+$/.exec(a))return a;a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");let c=XmlNode("numFmt").attr("numFmtId",++b).attr("formatCode",a);this.$numFmts.append(c);let e=this.$numFmts.children().length;return this.$numFmts.attr("count",e),b},_addFill:function(a){if(!a)return 0;let b=XmlNode("patternFill").attr("patternType",a.patternType||"solid");if(a.fgColor){let c=XmlNode("fgColor");a.fgColor.rgb?(6==a.fgColor.rgb.length&&(a.fgColor.rgb="FF"+a.fgColor.rgb),c.attr("rgb",a.fgColor.rgb),b.append(c)):a.fgColor.theme&&(c.attr("theme",a.fgColor.theme),a.fgColor.tint&&c.attr("tint",a.fgColor.tint),b.append(c)),a.bgColor||(a.bgColor={indexed:"64"})}if(a.bgColor){let c=XmlNode("bgColor").attr(a.bgColor);b.append(c)}let c=XmlNode("fill").append(b);this.$fills.append(c);let d=this.$fills.children().length;return this.$fills.attr("count",d),d-1},_getSubBorder:function(a,b){let c=XmlNode(a);if(b&&(b.style&&c.attr("style",b.style),b.color)){let a=XmlNode("color");b.color.auto?a.attr("auto",b.color.auto):b.color.rgb?a.attr("rgb",b.color.rgb):(b.color.theme||b.color.tint)&&(a.attr("theme",b.color.theme||"1"),a.attr("tint",b.color.tint||"0")),c.append(a)}return c},_addBorder:function(a){if(!a)return 0;let b=this,c=XmlNode("border").attr("diagonalUp",a.diagonalUp).attr("diagonalDown",a.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(d){c.append(b._getSubBorder(d,a[d]))}),this.$borders.append(c);let d=this.$borders.children().length;return this.$borders.attr("count",d),d-1},toXml:function(){return this.$styles.toXml()}}.initialize(a||{})};